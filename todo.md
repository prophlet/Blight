# Automatic Captcha

- Client sends 8 random bytes to the server, message RSA encrypted.

[ 
    
    SERVER - Generate 8 bytes. Generate every possible combination for those 8 bytes. 
    Pick 2 from every possible combination at random, send one to the client raw, 
    and argon hash the other and send it to the client.
    Combine the other one and the client's bytes, sha256 hash it, and store the hash.

]

- Server responds with 8 bytes and an argon hash, message AES encrypted using the client's 8 random bytes.

[

    CLIENT - Generate every possible combination of the 8 bytes that the server sent.
    For every byte in the generated bytes, combine the client's bytes with the server's bytes and argon hash.
    Continue until the argon hash verifies with the server's argon hash. 
    Once the server's bytes have been discovered, combine the server bytes and client bytes and sha256 hash it.
    
]

- Send a registration request to the server using the sha256 hash as the AES key for the message.
- If the server's sha256 hash matches the client's sha256 hash, continue. If there is a mismatch, block the client.


Change encryption key on server to not append the timestamp to it, but to just store it in the SQL db in a seperate column.






Client sends client bytes using RSA (32 bytes).
Server takes client bytes and server bytes (8 bytes server bytes), computes sha256 hash for them and stores the encryption key in "purgatory".
Server sends seed and server byte hash to client (aes encrypted using client bytes).

Client cracks hash using seed, generates same encryption key as server, and sends registration request.
    Request is formatted like this: AES_encrypted_client_data.RSA_encrypted_encryption_key

    The client data is encrypted using the encryption key, 

Server checks if the encryption key is in purgatory, and if the time hasn't expired.
    If the encryption key is in purgatory and it's not expired, insert the client data into the 'clients' table and delete the row from purgatory.
    If the key is expired, block the IP for 20 minutes. 
    If the key isn't in purgatory, block the IP forever.

Request IP will also be stored in purgatory. If the request IP isn't the same as the submission ip, block both.